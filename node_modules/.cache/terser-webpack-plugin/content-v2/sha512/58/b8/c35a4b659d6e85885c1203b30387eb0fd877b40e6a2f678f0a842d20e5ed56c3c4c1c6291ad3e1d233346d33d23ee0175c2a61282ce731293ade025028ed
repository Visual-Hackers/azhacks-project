{"code":"!function(t){function e(n){if(s[n])return s[n].exports;var o=s[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var s={};e.m=t,e.c=s,e.d=function(t,s,n){e.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:n})},e.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},e.t=function(t,s){if(1&s&&(t=e(t)),8&s)return t;if(4&s&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&s&&\"string\"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,\"a\",s),s},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=8)}([function(t){const e={UNSPECIFIED:\"PLATFORM_UNSPECIFIED\",FACEBOOK:\"FACEBOOK\",SLACK:\"SLACK\",TELEGRAM:\"TELEGRAM\",KIK:\"KIK\",SKYPE:\"SKYPE\",LINE:\"LINE\",VIBER:\"VIBER\",ACTIONS_ON_GOOGLE:\"ACTIONS_ON_GOOGLE\"},s=Object.keys(e).map(t=>e[t]),n=[e.FACEBOOK,e.SLACK,e.TELEGRAM,e.KIK,e.SKYPE,e.LINE,e.VIBER,e.ACTIONS_ON_GOOGLE];let o={};o[e.FACEBOOK]=\"facebook\",o[e.SLACK]=\"slack\",o[e.TELEGRAM]=\"telegram\",o[e.KIK]=\"kik\",o[e.SKYPE]=\"skype\",o[e.LINE]=\"line\",o[e.VIBER]=\"viber\",o[e.ACTIONS_ON_GOOGLE]=\"google\";const r={facebook:e.FACEBOOK,slack:e.SLACK,slack_testbot:e.SLACK,telegram:e.TELEGRAM,kik:e.KIK,skype:e.SKYPE,line:e.LINE,viber:e.VIBER,google:e.ACTIONS_ON_GOOGLE};t.exports={RichResponse:class{setPlatform(t){if(\"string\"!=typeof t||0>n.indexOf(t)&&t!==e.UNSPECIFIED)throw new Error(`Platform '${t}' not supported.`);return this.platform=t,this}},PLATFORMS:e,SUPPORTED_PLATFORMS:s,SUPPORTED_RICH_MESSAGE_PLATFORMS:n,V2_TO_V1_PLATFORM_NAME:o,V1_TO_V2_PLATFORM_NAME:r}},function(t,e,s){(function(n){function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==n&&\"env\"in n&&(t=n.env.DEBUG),t}(e=t.exports=s(12)).log=function(){return\"object\"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var s=this.useColors;if(t[0]=(s?\"%c\":\"\")+this.namespace+(s?\" %c\":\" \")+t[0]+(s?\"%c \":\" \")+\"+\"+e.humanize(this.diff),s){var n=\"color: \"+this.color;t.splice(1,0,n,\"color: inherit\");var o=0,r=0;t[0].replace(/%[a-zA-Z%]/g,function(t){\"%%\"===t||(o++,\"%c\"===t&&(r=o))}),t.splice(r,0,n)}},e.save=function(t){try{null==t?e.storage.removeItem(\"debug\"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){return\"undefined\"!=typeof window&&window.process&&\"renderer\"===window.process.type||\"undefined\"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||\"undefined\"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||\"undefined\"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/)&&31<=parseInt(RegExp.$1,10)||\"undefined\"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/)},e.storage=\"undefined\"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=[\"lightseagreen\",\"forestgreen\",\"goldenrod\",\"dodgerblue\",\"darkorchid\",\"crimson\"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return\"[UnexpectedJSONParseError]: \"+t.message}},e.enable(o())}).call(this,s(11))},function(t,e,s){const{RichResponse:n,PLATFORMS:o,SUPPORTED_RICH_MESSAGE_PLATFORMS:r,V2_TO_V1_PLATFORM_NAME:i}=s(0);t.exports=class extends n{constructor(t){if(super(),void 0===t||\"object\"==typeof t&&!t.text)throw new Error(\"string required by Text constructor\");if(\"string\"==typeof t)this.text=t;else if(\"object\"==typeof t&&(this.text=t.text,this.ssml=t.ssml,void 0!==t.platform&&t.platform!==o.UNSPECIFIED)){if(0>r.indexOf(t.platform))throw new Error(`Platform '${t.platform}' not supported.`);this.platform=t.platform}}setText(t){if(\"string\"!=typeof t)throw new Error(\"setText requires a string of the text\");return this.text=t,this}setSsml(t){if(\"string\"!=typeof t)throw new Error(\"setSsml requires a single string argument\");return this.ssml=t,this}getV1ResponseObject_(t){if(this.platform&&this.platform!==t)return null;let e;return t===o.ACTIONS_ON_GOOGLE?((e={type:\"simple_response\",platform:i[o.ACTIONS_ON_GOOGLE]}).textToSpeech=this.ssml||this.text,e.displayText=this.text):(e={type:0},-1<r.indexOf(t)&&(e.platform=i[t]),e.speech=this.text),e}getV2ResponseObject_(t){if(this.platform&&this.platform!==t)return null;let e;return t===o.ACTIONS_ON_GOOGLE?(e={platform:\"ACTIONS_ON_GOOGLE\",simpleResponses:{simpleResponses:[{}]}},this.ssml?e.simpleResponses.simpleResponses[0].ssml=this.ssml:e.simpleResponses.simpleResponses[0].textToSpeech=this.text,e.simpleResponses.simpleResponses[0].displayText=this.text):((e={text:{text:[]}}).text.text=[this.text],-1<r.indexOf(t)&&(e.platform=t)),e}}},function(t,e,s){const{RichResponse:n,PLATFORMS:o,SUPPORTED_RICH_MESSAGE_PLATFORMS:r,V2_TO_V1_PLATFORM_NAME:i}=s(0);t.exports=class extends n{constructor(t){if(super(),void 0===t||\"object\"==typeof t&&!t.title)throw new Error(\"title string required by Card constructor\");if(\"string\"==typeof t)this.title=t;else if(\"object\"==typeof t){if(this.title=t.title,this.text=t.text,this.imageUrl=t.imageUrl,!t.buttonText&&t.buttonUrl||!t.buttonUrl&&t.buttonText)throw new Error(\"card button requires both title and link\");if(this.buttonText=t.buttonText,this.buttonUrl=t.buttonUrl,void 0!==t.platform&&t.platform!==o.UNSPECIFIED){if(0>r.indexOf(t.platform))throw new Error(`Platform '${t.platform}' not supported.`);this.platform=t.platform}}}setTitle(t){if(\"string\"!=typeof t)throw new Error(\"setText requires a string of the text\");return this.title=t,this}setText(t){if(\"string\"!=typeof t)throw new Error(\"setText requires a string of the text\");return this.text=t,this}setImage(t){if(\"string\"!=typeof t)throw new Error(\"setImage requires a string of the image URL\");return this.imageUrl=t,this}setButton(t){if(!t.text&&t.url||!t.url&&t.text)throw new Error(\"card button requires button title and url. \\nUsage: setButton({text: 'button text', url: 'http://yoururlhere.com'}\");return this.buttonText=t.text,this.buttonUrl=t.url,this}getV1ResponseObject_(t){if(this.platform&&this.platform!==t)return null;let e;return t===o.ACTIONS_ON_GOOGLE?((e={type:\"basic_card\",platform:i[t]}).title=this.title,!this.text&&!this.imageUrl&&(e.formattedText=\" \"),this.text&&(e.formattedText=this.text),this.imageUrl&&(e.image={},e.image.url=this.imageUrl,e.image.accessibilityText=\"accessibility text\"),this.buttonText&&this.buttonUrl&&(e.buttons=[{openUrlAction:{}}],e.buttons[0].title=this.buttonText,e.buttons[0].openUrlAction.url=this.buttonUrl)):((e={type:1}).title=this.title,this.text&&(e.subtitle=this.text),this.imageUrl&&(e.imageUrl=this.imageUrl),t===o.SLACK&&(e.buttons=[]),this.buttonText&&this.buttonUrl&&(e.buttons=[],e.buttons[0]={},e.buttons[0].text=this.buttonText,e.buttons[0].postback=this.buttonUrl),-1<r.indexOf(t)&&(e.platform=i[t])),e}getV2ResponseObject_(t){if(this.platform&&this.platform!==t)return null;let e;return t===o.ACTIONS_ON_GOOGLE?((e={basicCard:{}}).basicCard.title=this.title,e.platform=o.ACTIONS_ON_GOOGLE,this.text&&(e.basicCard.formattedText=this.text),this.imageUrl&&(e.basicCard.image={},e.basicCard.image.imageUri=this.imageUrl,e.basicCard.image.accessibilityText=\"accessibility text\"),this.buttonText&&this.buttonUrl&&(e.basicCard.buttons=[{title:this.buttonText,openUriAction:{uri:this.buttonUrl}}])):((e={card:{}}).card.title=this.title,this.text&&(e.card.subtitle=this.text),this.imageUrl&&(e.card.imageUri=this.imageUrl),this.buttonText&&this.buttonUrl&&(e.card.buttons=[],e.card.buttons[0]={},e.card.buttons[0].text=this.buttonText,e.card.buttons[0].postback=this.buttonUrl),-1<r.indexOf(t)&&(e.platform=t)),e}}},function(t,e,s){const{RichResponse:n,PLATFORMS:o,SUPPORTED_RICH_MESSAGE_PLATFORMS:r,V2_TO_V1_PLATFORM_NAME:i}=s(0);t.exports=class extends n{constructor(t){if(super(),void 0===t||\"object\"==typeof t&&!t.imageUrl)throw new Error(\"image url string required by Image constructor\");if(\"string\"==typeof t)this.imageUrl=t;else if(\"object\"==typeof t&&(this.imageUrl=t.imageUrl,void 0!==t.platform&&t.platform!==o.UNSPECIFIED)){if(0>r.indexOf(t.platform))throw new Error(`Platform '${t.platform}' not supported.`);this.platform=t.platform}}setImage(t){if(\"string\"!=typeof t)throw new Error(\"setImage requires a string of the image URL\");return this.imageUrl=t,this}getV1ResponseObject_(t){if(this.platform&&this.platform!==t)return null;let e;return t===o.ACTIONS_ON_GOOGLE?(e={type:\"basic_card\",platform:i[t]},this.imageUrl&&(e.image={},e.image.url=this.imageUrl,e.image.accessibilityText=\"accessibility text\")):(e={type:3},this.imageUrl&&(e.imageUrl=this.imageUrl),-1<r.indexOf(t)&&(e.platform=i[t])),e}getV2ResponseObject_(t){if(this.platform&&this.platform!==t)return null;let e;return t===o.ACTIONS_ON_GOOGLE?((e={basicCard:{}}).platform=o.ACTIONS_ON_GOOGLE,this.imageUrl&&(e.basicCard.image={},e.basicCard.image.imageUri=this.imageUrl,e.basicCard.image.accessibilityText=\"accessibility text\")):(e={image:{}},this.imageUrl&&(e.image.imageUri=this.imageUrl),-1<r.indexOf(t)&&(e.platform=t)),e}}},function(t,e,s){const{RichResponse:n,PLATFORMS:o,SUPPORTED_RICH_MESSAGE_PLATFORMS:r,V2_TO_V1_PLATFORM_NAME:i}=s(0);t.exports=class extends n{constructor(t){if(super(),this.platform=void 0,this.replies=[],void 0===t||\"object\"==typeof t&&!t.title)throw new Error(\"Reply string required by Suggestion constructor\");if(\"string\"==typeof t)this.replies.push(t);else if(\"object\"==typeof t&&(this.replies.push(t.title),void 0!==t.platform&&t.platform!==o.UNSPECIFIED)){if(0>r.indexOf(t.platform))throw new Error(`Platform '${t.platform}' not supported.`);this.platform=t.platform}}setReply(t){if(\"string\"!=typeof t)throw new Error(`setReply requires a string but found ${typeof t}`);if(1!==this.replies.length)throw new Error(`Expected one reply in Suggestion object but found ${this.replies.length}`);return this.replies[0]=t,this}addReply_(t){if(\"string\"!=typeof t)throw new Error(`addReply requires a string but found ${typeof t}`);this.replies.push(t)}getV1ResponseObject_(t){if(this.platform&&this.platform!==t)return null;let e;return t===o.ACTIONS_ON_GOOGLE?(e={suggestions:[],type:\"suggestion_chips\",platform:i[t]},this.replies&&this.replies.forEach(t=>{e.suggestions.push({title:t})})):(e={type:2},this.replies&&(e.replies=this.replies),-1<r.indexOf(t)&&(e.platform=i[t])),e}getV2ResponseObject_(t){if(this.platform&&this.platform!==t)return null;let e;return t===o.ACTIONS_ON_GOOGLE?((e={suggestions:{suggestions:[]}}).platform=o.ACTIONS_ON_GOOGLE,this.replies.forEach(t=>{e.suggestions.suggestions.push({title:t})})):(e={quickReplies:{quickReplies:this.replies}},-1<r.indexOf(t)&&(e.platform=t)),e}}},function(t,e,s){const{RichResponse:n,PLATFORMS:o,V2_TO_V1_PLATFORM_NAME:r}=s(0);t.exports=class extends n{constructor(t,e,{sendAsMessage:s=!1,rawPayload:n=!1}={}){if(super(),!e||\"object\"==typeof t&&!t.payload)throw new Error(\"Payload can NOT be empty\");if(!t)throw new Error(\"Platform can NOT be empty\");e?(this.platform=t,this.payload=JSON.parse(JSON.stringify(e))):(this.platform=t.platform,this.payload=JSON.parse(JSON.stringify(t.payload))),this.sendAsMessage=s,this.rawPayload=n}setPayload(t){return this.payload=t,this}getPayload_(t){if(this.rawPayload)return this.payload;let e={};if(t===o.ACTIONS_ON_GOOGLE)e.google=this.payload;else{e[r[t]||t]=this.payload}return e}getV1ResponseObject_(){if(!this.sendAsMessage)return null;let t=r[this.platform]||this.platform;return{type:\"google\"===t?\"custom_payload\":4,platform:t,payload:this.getPayload_(this.platform)}}getV2ResponseObject_(){return this.sendAsMessage?{payload:this.getPayload_(this.platform),platform:this.platform}:null}}},function(t,e,s){const n=s(1)(\"dialogflow:debug\"),o=s(15);n.log=console.log.bind(console);t.exports=class{constructor(t,e){this.contexts={},this.session=e,t&&e?(this.inputContexts=this._processV2InputContexts(t),this.contexts=this._processV2InputContexts(t)):t&&(this.contexts=this._processV1InputContexts(t),this.inputContexts=this._processV1InputContexts(t))}set(t,e,s){if(!t||\"string\"!=typeof t&&\"string\"!=typeof t.name)throw new Error('Required \"name\" argument must be a string or an object with a string attribute \"name\"');\"string\"!=typeof t&&(s=t.parameters,e=t.lifespan,t=t.name),this.contexts[t]||(this.contexts[t]={name:t}),null!=e&&(this.contexts[t].lifespan=e),void 0!==s&&(this.contexts[t].parameters=s)}get(t){return this.contexts[t]}delete(t){this.set(t,0)}[Symbol.iterator](){let t=[];for(const e of Object.keys(this.contexts))t.push(this.contexts[e]);return t[Symbol.iterator]()}_removeOutgoingContext(t){delete this.contexts[t]}_processV1InputContexts(t){let e={};for(let s=0;s<t.length;s++){const n=t[s];e[n.name]={name:n.name,parameters:n.parameters,lifespan:n.lifespan}}return e}_processV2InputContexts(t){let e={};for(let s,n=0;n<t.length;n++){const o=(s=t[n]).name.split(\"/\")[6];e[o]={name:o,lifespan:s.lifespanCount,parameters:s.parameters}}return e}getV1OutputContextsArray(){let t=[];for(const e of this){if(this.inputContexts&&this.inputContexts[e.name]&&o.isEqual(e,this.inputContexts[e.name]))continue;let s={name:e.name};void 0!==e.lifespan&&(s.lifespan=e.lifespan),e.parameters&&(s.parameters=e.parameters),t.push(s)}return t}getV2OutputContextsArray(){let t=[];for(const e of this){if(this.inputContexts&&this.inputContexts[e.name]&&o.isEqual(e,this.inputContexts[e.name]))continue;let s={name:`${this.session}/contexts/${e.name}`};void 0!==e.lifespan&&(s.lifespanCount=e.lifespan),e.parameters&&(s.parameters=e.parameters),t.push(s)}return t}}},function(t,e,s){s(9)},function(t,e,s){const{DialogflowConversation:n}=s(10),o=s(1)(\"dialogflow:debug\");o.log=console.log.bind(console);const r=s(2),i=s(3),a=s(4),l=s(5),u=s(6),{RichResponse:c,PLATFORMS:p,SUPPORTED_PLATFORMS:h,SUPPORTED_RICH_MESSAGE_PLATFORMS:g}=s(0),f=s(14),d=s(16);t.exports={WebhookClient:class{constructor(t){if(!t.request)throw new Error(\"Request can NOT be empty.\");if(!t.response)throw new Error(\"Response can NOT be empty.\");for(let e in this.request_=t.request,this.response_=t.response,this.agentVersion=null,this.request_.body.result?this.agentVersion=1:this.request_.body.queryResult&&(this.agentVersion=2),this.responseMessages_=[],this.followupEvent_=null,this.endConversation_=!1,this.outgoingContexts_=[],this.intent=null,this.action=null,this.parameters=null,this.contexts=null,this.context=null,this.requestSource=null,this.originalRequest=null,this.query=null,this.locale=null,this.session=null,this.consoleMessages=[],this.alternativeQueryResults=null,p)e&&(this[e]=p[e]);if(2===this.agentVersion)this.client=new d(this);else{if(1!==this.agentVersion)throw new Error(\"Invalid or unknown request type (not a Dialogflow v1 or v2 webhook request).\");this.client=new f(this)}o(`Webhook request version ${this.agentVersion}`),this.client.processRequest_()}add(t){t instanceof Array?t.forEach(t=>this.addResponse_(t)):this.addResponse_(t)}end(t){this.client.end_(t)}addResponse_(t){if(\"string\"==typeof t&&(t=new r(t)),t instanceof n)this.client.addActionsOnGoogle_(t.serialize());else if(t instanceof l&&this.existingSuggestion_(t.platform))this.existingSuggestion_(t.platform).addReply_(t.replies[0]);else{if(t instanceof u&&this.existingPayload_(t.platform))throw new Error(`Payload response for ${t.platform} already defined.`);if(!(t instanceof c))throw new Error(`Unknown response type: \"${JSON.stringify(t)}\"`);this.responseMessages_.push(t)}}handleRequest(t){if(\"function\"==typeof t){let e=t(this);return Promise.resolve(e).then(()=>this.send_())}if(!(t instanceof Map))return Promise.reject(new Error(\"handleRequest must contain a map of Dialogflow intent names to function handlers\"));if(t.get(this.intent)){let e=t.get(this.intent)(this);return Promise.resolve(e).then(()=>this.send_())}if(t.get(null)){let e=t.get(null)(this);return Promise.resolve(e).then(()=>this.send_())}return o(\"No handler for requested intent\"),this.response_.status(400).status(\"No handler for requested intent\"),Promise.reject(new Error(\"No handler for requested intent\"))}setContext(t){return console.warn(\"setContext is deprecated, migrate to `context.set`\"),\"string\"==typeof t?this.context.set(t):this.context.set(t.name,t.lifespan,t.parameters),this}clearOutgoingContexts(){console.warn(\"clearOutgoingContexts is deprecated, migrate to `context.delete` or `context.set`\");for(const t of this.context)this.context._removeOutgoingContext(t.name);return this}clearContext(t){return console.warn(\"clearContext is deprecated, migrate to `context.delete` or `context.set`\"),this.context._removeOutgoingContext(t),this}getContext(t){console.warn(\"getContext is deprecated, migrate to `context.get`\");const e=this.context.get(t);return e?{name:t,lifespan:e.lifespan,parameters:e.parameters}:null}setFollowupEvent(t){if(\"string\"==typeof t)t={name:t};else if(\"string\"!=typeof t.name||!t.name)throw new Error(\"Followup event must be a string or have a name string\");this.client.setFollowupEvent_(t)}conv(){return this.requestSource===p.ACTIONS_ON_GOOGLE?new n(this.request_):null}send_(){const t=this.requestSource,e=this.responseMessages_;t!==p.ACTIONS_ON_GOOGLE||!e[0]||e[0]instanceof r||this.existingPayload_(p.ACTIONS_ON_GOOGLE)||(this.responseMessages_=[new r(\" \")].concat(e));const s=this.existingPayload_(t);1===e.length&&e[0]instanceof r?this.client.addTextResponse_():(-1<g.indexOf(this.requestSource)||0>h.indexOf(this.requestSource))&&this.client.addMessagesResponse_(t),s&&this.client.addPayloadResponse_(s,t),this.client.sendResponses_(t)}existingSuggestion_(t){let e;for(let s of this.responseMessages_)if(s instanceof l){if(!(s.platform&&s.platform!==p.UNSPECIFIED||t&&t!==p.UNSPECIFIED)){e=s;break}if(t===s.platform){e=s;break}}return e}existingPayload_(t){let e;for(let s of this.responseMessages_)if(s instanceof u){if(!(s.platform&&s.platform!==p.UNSPECIFIED||t&&t!==p.UNSPECIFIED)){e=s;break}if(t===s.platform){e=s;break}}return e}},Text:r,Card:i,Image:a,Suggestion:l,Payload:u}},function(t){t.exports=actions-on-google},function(t){function e(){throw new Error(\"setTimeout has not been defined\")}function s(){throw new Error(\"clearTimeout has not been defined\")}function n(t){if(l===setTimeout)return setTimeout(t,0);if((l===e||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function o(){g&&p&&(g=!1,p.length?h=p.concat(h):f=-1,h.length&&r())}function r(){if(!g){var t=n(o);g=!0;for(var e=h.length;e;){for(p=h,h=[];++f<e;)p&&p[f].run();f=-1,e=h.length}p=null,g=!1,function(t){if(u===clearTimeout)return clearTimeout(t);if((u===s||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}(t)}}function i(t,e){this.fun=t,this.array=e}function a(){}var l,u,c=t.exports={};!function(){try{l=\"function\"==typeof setTimeout?setTimeout:e}catch(t){l=e}try{u=\"function\"==typeof clearTimeout?clearTimeout:s}catch(t){u=s}}();var p,h=[],g=!1,f=-1;c.nextTick=function(t){var e=Array(arguments.length-1);if(1<arguments.length)for(var s=1;s<arguments.length;s++)e[s-1]=arguments[s];h.push(new i(t,e)),1!==h.length||g||n(r)},i.prototype.run=function(){this.fun.apply(null,this.array)},c.title=\"browser\",c.browser=!0,c.env={},c.argv=[],c.version=\"\",c.versions={},c.on=a,c.addListener=a,c.once=a,c.off=a,c.removeListener=a,c.removeAllListeners=a,c.emit=a,c.prependListener=a,c.prependOnceListener=a,c.listeners=function(){return[]},c.binding=function(){throw new Error(\"process.binding is not supported\")},c.cwd=function(){return\"/\"},c.chdir=function(){throw new Error(\"process.chdir is not supported\")},c.umask=function(){return 0}},function(t,e,s){function n(t){function s(){if(s.enabled){var t=s,n=+new Date,r=n-(o||n);t.diff=r,t.prev=o,t.curr=n,o=n;for(var i=Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=e.coerce(i[0]),\"string\"!=typeof i[0]&&i.unshift(\"%O\");var l=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(s,n){if(\"%%\"===s)return s;l++;var o=e.formatters[n];if(\"function\"==typeof o){var r=i[l];s=o.call(t,r),i.splice(l,1),l--}return s}),e.formatArgs.call(t,i),(s.log||e.log||console.log.bind(console)).apply(t,i)}}return s.namespace=t,s.enabled=e.enabled(t),s.useColors=e.useColors(),s.color=function(t){var s,n=0;for(s in t)n=(n<<5)-n+t.charCodeAt(s),n|=0;return e.colors[Math.abs(n)%e.colors.length]}(t),\"function\"==typeof e.init&&e.init(s),s}var o;(e=t.exports=n.debug=n.default=n).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable(\"\")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];for(var s=(\"string\"==typeof t?t:\"\").split(/[\\s,]+/),n=s.length,o=0;o<n;o++)s[o]&&(\"-\"===(t=s[o].replace(/\\*/g,\".*?\"))[0]?e.skips.push(new RegExp(\"^\"+t.substr(1)+\"$\")):e.names.push(new RegExp(\"^\"+t+\"$\")))},e.enabled=function(t){var s,n;for(s=0,n=e.skips.length;s<n;s++)if(e.skips[s].test(t))return!1;for(s=0,n=e.names.length;s<n;s++)if(e.names[s].test(t))return!0;return!1},e.humanize=s(13),e.names=[],e.skips=[],e.formatters={}},function(t){function e(t){if(!(100<(t+=\"\").length)){var e=/^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var s=parseFloat(e[1]),n=(e[2]||\"ms\").toLowerCase();return\"years\"===n||\"year\"===n||\"yrs\"===n||\"yr\"===n||\"y\"===n?s*u:\"days\"===n||\"day\"===n||\"d\"===n?s*l:\"hours\"===n||\"hour\"===n||\"hrs\"===n||\"hr\"===n||\"h\"===n?s*a:\"minutes\"===n||\"minute\"===n||\"mins\"===n||\"min\"===n||\"m\"===n?s*i:\"seconds\"===n||\"second\"===n||\"secs\"===n||\"sec\"===n||\"s\"===n?s*r:\"milliseconds\"===n||\"millisecond\"===n||\"msecs\"===n||\"msec\"===n||\"ms\"===n?s:void 0}}}function s(t){var e=Math.round;return t>=l?e(t/l)+\"d\":t>=a?e(t/a)+\"h\":t>=i?e(t/i)+\"m\":t>=r?e(t/r)+\"s\":t+\"ms\"}function n(t){return o(t,l,\"day\")||o(t,a,\"hour\")||o(t,i,\"minute\")||o(t,r,\"second\")||t+\" ms\"}function o(t,e,s){return t<e?void 0:t<1.5*e?Math.floor(t/e)+\" \"+s:Math.ceil(t/e)+\" \"+s+\"s\"}var r=1e3,i=60*r,a=60*i,l=24*a,u=365.25*l;t.exports=function(t,o){o=o||{};var r=typeof t;if(\"string\"==r&&0<t.length)return e(t);if(\"number\"==r&&!1===isNaN(t))return o.long?n(t):s(t);throw new Error(\"val is not a non-empty string or a valid number. val=\"+JSON.stringify(t))}},function(t,e,s){const n=s(1)(\"dialogflow:debug\");n.log=console.log.bind(console);const{V1_TO_V2_PLATFORM_NAME:o,PLATFORMS:r}=s(0),i=s(2),a=s(3),l=s(4),u=s(5),c=s(6),p=s(7);t.exports=class{constructor(t){return this.agent=t,this}processRequest_(){this.agent.intent=this.agent.request_.body.result.metadata.intentName,n(`Intent: ${this.agent.intent}`),this.agent.action=this.agent.request_.body.result.action,n(`Action: ${this.agent.action}`),this.agent.parameters=this.agent.request_.body.result.parameters,n(`Parameters: ${JSON.stringify(this.agent.parameters)}`),this.agent.contexts=this.agent.request_.body.result.contexts,n(`Input contexts: ${JSON.stringify(this.agent.contexts)}`),this.agent.context=new p(this.agent.request_.body.result.contexts);let t=this.agent.request_.body.originalRequest;if(t){const e=t.source||t.data.source;this.agent.requestSource=o[e]||e}n(`Request source: ${JSON.stringify(this.agent.requestSource)}`);let e=Object.assign({},t);if(t&&t.data){const t=Object.getOwnPropertyDescriptor(e,\"data\");Object.defineProperty(e,\"payload\",t),delete e.data}if(this.agent.originalRequest=e,n(`Original Request: ${JSON.stringify(this.agent.originalRequest)}`),this.agent.query=this.agent.request_.body.result.resolvedQuery,n(`Original query: ${JSON.stringify(this.agent.query)}`),this.agent.locale=this.agent.request_.body.lang,this.agent.request_.body.result.fulfillment.messages){const t=this.agent.request_.body.result.fulfillment.messages;this.agent.consoleMessages=this.getConsoleMessages_(t)}else this.agent.consoleMessages=[];n(`Console messages: ${JSON.stringify(this.agent.consoleMessages)}`)}addTextResponse_(){const t=this.agent.responseMessages_[0],e=t.ssml||t.text;this.addJson_({speech:e,displayText:t.text})}addPayloadResponse_(t,e){this.addJson_({data:t.getPayload_(e)})}addMessagesResponse_(t){let e=this.buildResponseMessages_(t);0<e.length&&this.addJson_({messages:e})}addJson_(t){this.responseJson_||(this.responseJson_={}),Object.assign(this.responseJson_,t)}sendResponses_(t){let e=this.responseJson_;if(!e)throw new Error(`No responses defined for platform: ${t}`);e.contextOut=this.agent.context.getV1OutputContextsArray(),this.agent.followupEvent_&&(e.followupEvent=this.agent.followupEvent_),n(\"Response to Dialogflow: \"+JSON.stringify(e)),this.agent.response_.json(e)}buildResponseMessages_(t){return this.agent.responseMessages_.map(e=>e.getV1ResponseObject_(t)).filter(t=>t)}addContext_(t){this.agent.context.set(t)}setFollowupEvent_(t){let e={name:t.name};t.parameters&&(e.data=t.parameters),this.agent.followupEvent_=e}end_(){throw new Error('\"end\" method is not supported on Dialogflow API V1.  Please migrate to Dialogflow API V2.')}addActionsOnGoogle_(t){t.contextOut&&t.contextOut.forEach(t=>{this.addContext_(t)}),this.agent.add(new c(r.ACTIONS_ON_GOOGLE,t.data.google))}getConsoleMessages_(t){const e={0:this.convertTextJson_,1:this.convertCardJson_,2:this.convertQuickRepliesJson_,3:this.convertImageJson_,4:this.convertPayloadJson_,custom_payload:this.convertPayloadJson_,simple_response:this.convertSimpleResponsesJson_,basic_card:this.convertBasicCardJson_,suggestion_chips:this.convertSuggestionsJson_};let s=[];return t.forEach(t=>{if(e[t.type]){let n=e[t.type](t,o[t.platform]);n&&(s=s.concat(n))}else n(`Unsupported console message type \"${richMessageType}\"`)}),s}convertTextJson_(t,e){return t.speech?new i({text:t.speech,platform:e}):null}convertCardJson_(t,e){return new a({title:t.title||\" \",text:t.subtitle,imageUrl:t.imageUrl,buttonText:t.buttons?t.buttons[0].text:null,buttonUrl:t.buttons?t.buttons[0].postback:null,platform:e})}convertQuickRepliesJson_(t,e){if(!t.suggestions)return null;let s=[];return t.suggestions.forEach((n,o)=>{s.push(new u({title:t.replies[o],platform:e}))}),s}convertImageJson_(t,e){return new l({imageUrl:t.imageUrl,platform:e})}convertPayloadJson_(t,e){return new c(e,t.payload,{rawPayload:!0,sendAsMessage:!0})}convertSimpleResponsesJson_(t,e){return new i({text:t.textToSpeech,platform:e})}convertBasicCardJson_(t,e){return new a({title:t.title||\" \",text:t.formattedText,imageUrl:t.image?t.image.url:null,buttonText:0==t.buttons.length?null:t.buttons[0].title,buttonUrl:0==t.buttons.length?null:t.buttons[0].openUrlAction.url,platform:e})}convertSuggestionsJson_(t,e){if(!t.suggestions)return null;let s=[];return t.suggestions.forEach((n,o)=>{s.push(new u({title:t.suggestions[o].title,platform:e}))}),s}}},function(t){t.exports=lodash},function(t,e,s){const n=s(1)(\"dialogflow:debug\");n.log=console.log.bind(console);const{V1_TO_V2_PLATFORM_NAME:o,PLATFORMS:r}=s(0),i=s(2),a=s(3),l=s(4),u=s(5),c=s(6),p=s(7);t.exports=class{constructor(t){return this.agent=t,this}processRequest_(){this.agent.intent=this.agent.request_.body.queryResult.intent.displayName,n(`Intent: ${this.agent.intent}`),this.agent.action=this.agent.request_.body.queryResult.action?this.agent.request_.body.queryResult.action:null,n(`Action: ${this.agent.action}`),this.agent.session=this.agent.request_.body.session,n(`v2 Session: ${JSON.stringify(this.agent.session)}`),this.agent.parameters=this.agent.request_.body.queryResult.parameters||{},n(`Parameters: ${JSON.stringify(this.agent.parameters)}`),this.agent.contexts=this.agent.request_.body.queryResult.outputContexts?this.agent.request_.body.queryResult.outputContexts.map(t=>this.convertV2ContextToV1Context_(t)):[],n(`Request contexts: ${JSON.stringify(this.agent.contexts)}`),this.agent.context=new p(this.agent.request_.body.queryResult.outputContexts,this.agent.session);const t=this.agent.request_.body.originalDetectIntentRequest;if(t){const e=t.source||t.payload&&t.payload.source||null;this.agent.requestSource=o[e]||e}if(n(`Request source: ${JSON.stringify(this.agent.requestSource)}`),this.agent.originalRequest=this.agent.request_.body.originalDetectIntentRequest,n(`Original Request: ${JSON.stringify(this.agent.originalRequest)}`),this.agent.query=this.agent.request_.body.queryResult.queryText,n(`Original query: ${JSON.stringify(this.agent.query)}`),this.agent.locale=this.agent.request_.body.queryResult.languageCode,n(`Request locale: ${JSON.stringify(this.agent.query)}`),this.agent.request_.body.queryResult.fulfillmentMessages){const t=this.agent.request_.body.queryResult.fulfillmentMessages;this.agent.consoleMessages=this.getConsoleMessages_(t)}else this.agent.consoleMessages=[];n(`Console messages: ${JSON.stringify(this.agent.consoleMessages)}`),this.agent.request_.body.alternativeQueryResults&&(this.agent.alternativeQueryResults=this.agent.request_.body.alternativeQueryResults),n(`Alternative query result: ${JSON.stringify(this.agent.alternativeQueryResults)}`)}addTextResponse_(){const t=this.agent.responseMessages_[0],e=t.ssml||t.text;this.addJson_({fulfillmentText:e})}addPayloadResponse_(t,e){this.addJson_({payload:t.getPayload_(e)})}addMessagesResponse_(t){let e=this.buildResponseMessages_(t);0<e.length&&this.addJson_({fulfillmentMessages:e})}addJson_(t){this.responseJson_||(this.responseJson_={}),Object.assign(this.responseJson_,t)}sendResponses_(t){let e=this.responseJson_;if(!e)throw new Error(`No responses defined for platform: ${t}`);e.outputContexts=this.agent.context.getV2OutputContextsArray(),this.agent.followupEvent_&&(e.followupEventInput=this.agent.followupEvent_),this.agent.endConversation_&&(e.triggerEndOfConversation=this.agent.endConversation_),n(\"Response to Dialogflow: \"+JSON.stringify(e)),this.agent.response_.json(e)}buildResponseMessages_(t){return this.agent.responseMessages_.map(e=>e.getV2ResponseObject_(t)).filter(t=>t)}addContext_(t){t.name.match(\"/contexts/\")&&(t=this.convertV2ContextToV1Context_(t)),this.agent.context.set(t)}convertV2ContextToV1Context_(t){let e={};const s=this.agent.session.length+10;return e.name=t.name.slice(s),e.lifespan=t.lifespanCount,e.parameters=t.parameters,e}setFollowupEvent_(t){t.languageCode||(t.languageCode=this.agent.locale),this.agent.followupEvent_=t}end_(t){this.agent.endConversation_=!0,this.agent.add(t)}addActionsOnGoogle_(t){t.outputContexts&&t.outputContexts.forEach(t=>{this.addContext_(t)}),this.agent.add(new c(r.ACTIONS_ON_GOOGLE,t.payload.google))}getConsoleMessages_(t){const e={text:this.convertTextJson_,card:this.convertCardJson_,image:this.convertImageJson_,payload:this.convertPayloadJson_,quickReplies:this.convertQuickRepliesJson_,simpleResponses:this.convertSimpleResponsesJson_,basicCard:this.convertBasicCardJson_,suggestions:this.convertSuggestionsJson_};let s=[];return t.forEach(t=>{const o=Object.keys(t).find(t=>\"platform\"!==t);if(e[o]){const n=t.platform?t.platform:void 0;let r=e[o](t,n);r&&(s=s.concat(r))}else n(`Unsupported console message type \"${o}\"`)}),s}convertTextJson_(t,e){return t.text.text[0]?new i({text:t.text.text[0],platform:e}):null}convertCardJson_(t,e){return new a({title:t.card.title||\" \",text:t.card.subtitle,imageUrl:t.card.imageUri,buttonText:t.card.buttons?t.card.buttons[0].text:null,buttonUrl:t.card.buttons?t.card.buttons[0].postback:null,platform:e})}convertImageJson_(t,e){return new l({imageUrl:t.image.imageUri,platform:e})}convertPayloadJson_(t,e){return new c(e,t.payload,{rawPayload:!0,sendAsMessage:!0})}convertQuickRepliesJson_(t,e){if(!t.suggestions)return null;let s=[];return t.suggestions.forEach((n,o)=>{s.push(new u({title:t.quickReplies.quickReplies[o],platform:e}))}),s}convertSimpleResponsesJson_(t,e){return new i({text:t.simpleResponses.simpleResponses[0].textToSpeech,platform:e})}convertBasicCardJson_(t,e){return new a({title:t.basicCard.title||\" \",text:t.basicCard.formattedText,imageUrl:t.basicCard.image?t.basicCard.image.imageUri:null,buttonText:t.basicCard.buttons?t.basicCard.buttons[0].title:null,buttonUrl:t.basicCard.buttons?t.basicCard.buttons[0].openUriAction.uri:null,platform:e})}convertSuggestionsJson_(t,e){if(!t.suggestions)return null;let s=[];return t.suggestions.suggestions.forEach((n,o)=>{s.push(new u({title:t.suggestions.suggestions[o].title,platform:e}))}),s}}}]);","extractedComments":[]}